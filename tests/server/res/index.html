<html>
  <head>
    <title>Visualizer</title>
    <meta charset=utf-8>
    <style>
			body { 
				margin: 0; 
				background-color: #f0f0f0;
			}
			canvas { 
				width: 100%; 
				height: 100% 
			}
		</style>
  </head>
  <body>
    <script src="three.min.js"></script>
		<script>
			var sendRequest = function() {
				var xhr = new XMLHttpRequest();

				xhr.onreadystatechange = function () {
					if (this.readyState != 4) return;

					if (this.status == 200) {
						var data = JSON.parse(this.responseText);

						// we get the returned data
						console.log(data[0]);
					}

					// end of state change: it can be after some time (async)
				};

				xhr.open("POST", "/get_matrix", true);
				xhr.setRequestHeader('Content-Type', 'application/json');
				xhr.send(JSON.stringify({var1: "lol", var2: "lol2"}));
			}

		</script>
		<script>
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 1000 );

			var renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );

			var geometry = new THREE.BoxGeometry( 1, 1, 1 );
			var material = new THREE.MeshNormalMaterial();
			var cube = new THREE.Mesh( geometry, material );
			scene.add( cube );
			scene.background = new THREE.Color( 0xffffff );

			camera.position.z = 10;
			camera.position.y = 4;
			camera.lookAt(new THREE.Vector3(0,0,0));

			cube.matrixAutoUpdate = false;

			var render = function () {
				requestAnimationFrame( render );

				cube.matrix.set(1, 0, 0, -1.5,
												0, 1, 0, 1,
												0, 0, 1, 0,
												0, 0, 0, 1 );

				renderer.render(scene, camera);
			};

			render();
			sendRequest();
		</script>
  </body>
</html>